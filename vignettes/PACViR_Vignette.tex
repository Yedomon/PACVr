\documentclass[letterpaper]{article}

% PACKAGE DEFINITION
\usepackage{fancyvrb}
\usepackage{fullpage}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{float}
\usepackage{hyperref}
\usepackage{graphicx}
\usepackage{tcolorbox}

% CUSTOM FUNCTIONS
\tcbuselibrary{skins,breakable}
\newenvironment{BGVerbatim}
 {\VerbatimEnvironment
  \begin{tcolorbox}[
    breakable,
    colback=orange!10,
    spartan
  ]%
  \begin{Verbatim}}
 {\end{Verbatim}\end{tcolorbox}}

\author{Michael Gruenstaeudl, Nils Jenke}
\title{Using PACViR}


\begin{document}
\maketitle
\tableofcontents

\section{Introduction}
PACViR is a user-friendly software tool to visualize the coverage depth of a complete plastid genome as well as the equality of its IR regions while simultaneously accounting for the circular, quadripartite structure of the genome. This vignette provides two examples of executing PACViR on empirical data via the R function \texttt{PACViR.complete()} from within the R interpreter and from the BASH commandline shell.

\section{Requirements}
To run PACViR, several dependencies have to be installed.

\begin{BGVerbatim}[fontsize=\normalsize]
# Mosdepth (a general dependency)
system("conda install -y mosdepth")
# CRAN packages
if (!require("pacman"))
    install.packages("pacman")
pacman::p_load("RCircos", "optparse", install=TRUE)
# Bioconductor packages
if (!requireNamespace("BiocManager", quietly=TRUE))
    install.packages("BiocManager")
if (!requireNamespace("genbankr", quietly=TRUE))
    BiocManager::install("genbankr")
\end{BGVerbatim}

\pagebreak

\section{Executing PACViR via R interpreter}
PACViR can be executed via the R function \texttt{PACViR.complete()} from within the R interpreter.

\begin{BGVerbatim}[fontsize=\normalsize]
library(PACViR)
# MH161174
## Specify input files
gbkFile <- system.file("extdata", "MH161174/MH161174.gb", package="PACViR")
bamFile <- system.file("extdata", "MH161174/MH161174_PlastomeReadsOnly.sorted.bam", 
                       package="PACViR")
## Specify output file
outFile <- paste(getwd(), "/MH161174_AssemblyCoverage_viz.pdf", sep="")
## Run PACViR
PACViR.complete(gbk.file=gbkFile, bam.file=bamFile, windowSize=250, 
                mosdepthCmd='mosdepth', threshold=15, delete=TRUE, 
                output=outFile)
\end{BGVerbatim}
  
\begin{figure}[H]
\centering
    \includegraphics[width=0.75\textwidth]{MH161174_AssemblyCoverage_viz.pdf}
    \caption{File \texttt{MH161174\_AssemblyCoverage\_viz.svg} as generated via \texttt{PACViR.complete()}}
\centering
\end{figure}

\pagebreak

\section{Executing PACViR via BASH shell}
PACViR can be executed via the BASH shell command \texttt{PACViR\_Rscript.R} from the BASH commandline shell.
  
\begin{BGVerbatim}[fontsize=\normalsize]
# MH899017
Rscript ./inst/extdata/PACViR_Rscript.R  \
     -k ./inst/extdata/MH899017.gb \
     -b ./inst/extdata/MH899017_PlastomeReadsOnly.sorted.bam \
     -o ./MH899017_AssemblyCoverage_viz.pdf
\end{BGVerbatim}

\begin{figure}[H]
\centering
    \includegraphics[width=0.75\textwidth]{MH899017_AssemblyCoverage_viz.pdf}
    \caption{File \texttt{MH899017\_AssemblyCoverage\_viz.svg} as generated via \texttt{PACViR\_Rscript.R}}
\centering
\end{figure}

\pagebreak

%\section{Modifying parameters}
%  Depending on which system PACViR will be executed

%\section{More Information}

\section{sessionInfo}
\begin{Verbatim}
> sessionInfo()
R version 3.3.3 (2017-03-06)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Debian GNU/Linux 9 (stretch)

locale:
 [1] LC_CTYPE=de_DE.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=de_DE.UTF-8        LC_COLLATE=de_DE.UTF-8    
 [5] LC_MONETARY=de_DE.UTF-8    LC_MESSAGES=de_DE.UTF-8   
 [7] LC_PAPER=de_DE.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=de_DE.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] stats     graphics  grDevices utils     datasets 
[6] methods   base     

loaded via a namespace (and not attached):
[1] tools_3.3.3
\end{Verbatim}

\end{document}
